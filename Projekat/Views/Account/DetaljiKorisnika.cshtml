<div id="sredina" class="sredina-upload-mat">
    @model Projekat.Models.DetaljiKorisnikaViewModel
    @{
        ViewBag.Title = "Detalji Korisnika";
        Layout = "~/Views/Shared/_Layout.cshtml";
    }
    <style>
        @@media screen and (max-width: 600px) {
            .smanji{
                width:100%;
            }
            .btnsOnDetalji {
                width: 100%;
                clear: both;
                float: left;
                text-align:center;
             }

            .btnReset {
                width: 100%;
                clear: both;
                float: left;
            }
            }

                                    
    </style>
    <h2 style="margin-left:20px;">@ViewBag.Title</h2>

    <div class="form-detalji" role="form">


        <h4>Detalji korisnika: @Model.Korisnik.UserName</h4>



        <img src="data:image;base64,@System.Convert.ToBase64String(Model.Korisnik.Slika)" class="slika" />
        <table>
            <tr> <td class="kategorija"> <label class="labele">Ime: &nbsp</label> </td> <td>  <label class="labelaIzBaze">@Model.Korisnik.Ime</label> </td> </tr>

            <tr> <td class="kategorija"> <label class="labele">Prezime: &nbsp</label>   </td> <td>    <label class="labelaIzBaze">@Model.Korisnik.Prezime</label>  </td> </tr>


            <tr> <td class="kategorija"><label class="labele">Email: &nbsp</label>   </td> <td>      <label class="labelaIzBaze">@Model.Korisnik.Email</label> </td> </tr>

            <tr> <td class="kategorija"><label class="labele">Broj telefona: &nbsp</label>    </td> <td>    <label class="labelaIzBaze">@Model.Korisnik.PhoneNumber</label> </td> </tr>



            <tr> <td class="kategorija"><label class="labele">Uloga: &nbsp</label>    </td> <td>    <label class="labelaIzBaze">@Model.Korisnik.Uloga</label></td> </tr>
            @{ if (Model.Korisnik.Uloga == "Ucenik")
                {
                    <tr> <td class="kategorija"><label class="labele">Skola: &nbsp</label>   </td> <td>      <label class="labelaIzBaze">@Model.SelektovanaSkola</label></td> </tr>

                    <tr> <td class="kategorija"><label class="labele">Godina upisa: &nbsp</label>   </td> <td>      <label class="labelaIzBaze">@Model.Korisnik.GodinaUpisa</label></td> </tr>

                    <tr> <td class="kategorija"><label class="labele">Smer: &nbsp</label>   </td> <td>      <label class="labelaIzBaze">@Model.SelektovaniSmer</label></td> </tr>
                }
                else if (Model.Korisnik.Uloga == "Profesor")
                {
                    <tr> <td class="kategorija"><label class="labele">Skola: &nbsp</label>   </td> <td>      <label class="labelaIzBaze">@Model.SelektovanaSkola</label></td> </tr>
                }
            }




        </table>
        <p>

            @using (Html.BeginForm("IzmeniKorisnika", "Account", new { ID = Model.Korisnik.Id }, FormMethod.Get))
            {

                <input type="submit" class="btnsOnDetalji" value="IZMENI" />
            }

            @using (Html.BeginForm("ObrisiKorisnika", "Account", new { ID = Model.Korisnik.Id }, FormMethod.Post))
            {

                <input type="button"class="btnsOnDetalji brisi" value="OBRISI" data-toggle="modal" data-target="#myModal" />
            }

            @using (Html.BeginForm("DetaljiKorisnika", "Account", new { ID = Model.Korisnik.Id }, FormMethod.Post))
            {

                <input type="submit"class="btnReset" value="RESETUJ PASSWORD" onclick="return confirm('Molimo vas potvrdite resetovanje sifre')" />
            }

        </p>

        <div class="modal fade" id="myModal" role="dialog" style="opacity:1; background-color:rgba(0,0,0,0.5);">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Potvrda brisanja</h4>
                    </div>
                    <div class="modal-body">
                        <img src="~/Content/img/kantaPotvrdaBrisanjaModal.png" id="kantaModalSlika" alt="kanta" />
                        <p>Da li ste sigurni da želite da obrišete korisnika?</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Potvrdi</button>
                        <button type="button" class="btn btn-default btn-sekundarni" data-dismiss="modal">Odustani</button>
                    </div>
                </div>
            </div>
        </div>

        <script>
            var idK=@Html.Raw(Json.Encode(Model.Korisnik.Id));
            $(document).ready(function () {

                var data = sessionStorage.getItem('kantica');
                if (data) {
                    $('#banana').css('display', 'block').attr('src', '').attr('src', '../../Content/img/potvrdaBrisanjaGIFGOTOV.gif');
                    setTimeout(function () { $('#banana').css('display', 'none') }, 2000);
                    sessionStorage.removeItem('kantica');
                }

                $(".brisi").click(function () {
                    $delete = $(this);

                    

                     

                    $('button.btn-default:first').click(function () {
                        $.ajax({
                            url: '/Account/ObrisiKorisnika/idK',
                            method: 'post',
                            data: { id: idK },
                            complete: function () {
                                $delete.parent().parent().parent().parent().remove();
                                sessionStorage.setItem('kantica', true);

                                window.location.replace('/Account/ListaKorisnika');

                            }
                        });
                    });
                });
            });
        </script>






    </div>
</div>

@section Scripts{

   
    @Scripts.Render("~bundles/Content/css")

}